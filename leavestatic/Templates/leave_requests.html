{% extends 'main.html' %}
{% load static %}

{% block title %}
    Leave Requests
{% endblock %}

{% block content %}
    <div class="approvals-container">

  <!-- Pending Approvals -->
  <section class="approvals-section approvals-pending">
    <h2>Pending Approvals</h2>
    <div class="cards">
      {% if pending_approvals %}
        {% for approval in pending_approvals %}
          <div class="approval-card pending">
            <header class="card-header">
              <h3>{{ approval.request.applicant.first_name }} {{ approval.request.applicant.last_name }}</h3>
              <span class="status-label">{{ approval.get_status_display }}</span>
            </header>
            <div class="card-body">
              <p><strong>Date:</strong> {{ approval.request.application_date }}</p>
              <p><strong>Type:</strong> {{ approval.request.type.name }}</p>
              <p><strong>Days Requested:</strong> {{ approval.request.days_requested }}</p>
            </div>
            <footer class="card-actions">
              <form action="" method="post" class="inline-form">
                {% csrf_token %}
                <input type="hidden" name="approval_id" value="{{approval.id}}" id="">
                <input type="hidden" name="form_meta" value="approve" id="">
                <button type="submit" class="btn btn-success">Approve</button>
              </form>
              <form action="" method="post" class="inline-form">
                {% csrf_token %}
                <input type="hidden" name="approval_id" value="{{approval.id}}" id="">
                <input type="hidden" value="deny" name="form_meta" id="">
                <button type="submit" class="btn btn-danger">Deny</button>
              </form>
            </footer>
          </div>
        {% endfor %}
      {% else %}
        <p class="no-items">No pending approvals.</p>
      {% endif %}
    </div>
  </section>

  <hr>

  <!-- Approved Approvals -->
  <section class="approvals-section approvals-approved">
    <h2>Approved Approvals</h2>
    <div class="cards">
      {% if approved_approvals %}
        {% for approval in approved_approvals %}
          <div class="approval-card approved">
            <header class="card-header">
              <h3>{{ approval.request.applicant.first_name }} {{ approval.request.applicant.last_name }}</h3>
              <span class="status-label">{{ approval.get_status_display }}</span>
            </header>
            <div class="card-body">
              <p><strong>Date:</strong> {{ approval.request.application_date }}</p>
              <p><strong>Type:</strong> {{ approval.request.type.name }}</p>
              <p><strong>Days Approved:</strong> {{ approval.days_approved }}</p>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <p class="no-items">No approved approvals.</p>
      {% endif %}
    </div>
  </section>

  <hr>

  <!-- Denied Approvals -->
  <section class="approvals-section approvals-denied">
    <h2>Denied Approvals</h2>
    <div class="cards">
      {% if denied_approvals %}
        {% for approval in denied_approvals %}
          <div class="approval-card denied">
            <header class="card-header">
              <h3>{{ approval.request.applicant.first_name }} {{ approval.request.applicant.last_name }}</h3>
              <span class="status-label">{{ approval.get_status_display }}</span>
            </header>
            <div class="card-body">
              <p><strong>Date:</strong> {{ approval.request.application_date }}</p>
              <p><strong>Type:</strong> {{ approval.request.type.name }}</p>
              <p><strong>Reason:</strong> {{ approval.reason|default:"â€”" }}</p>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <p class="no-items">No denied approvals.</p>
      {% endif %}
    </div>
  </section>

</div>
{% endblock %}