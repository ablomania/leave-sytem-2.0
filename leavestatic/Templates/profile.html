{% extends 'main.html' %}
{% load static %}

{% block title %}
    Profile
{% endblock %}

{% block content %}
    <div class="profile-wrapper modern-profile">
    <!-- Profile View Section -->
    <div class="profile-view">
        <div class="profile-header">
            <div class="profile-header-title">
                <a href="{% url 'dashboard' slug %}" class="back-link">
                    <img src="{% static 'images/back.png' %}" width="25" height="25" alt="Back" class="back-image">
                </a>
                <h1>Profile</h1>
            </div>
            <div class="profile-buttons">
                <button type="button" class="edit-btn" onclick="document.querySelector('.profile-change').scrollIntoView({ behavior: 'smooth' })">Edit Profile</button>
                <a href="" class="reset-password-btn button-secondary">Reset Password</a>
            </div>
        </div>

        <div class="profile-sections">
            <!-- Personal Info -->
            <div class="profile-card fade-in">
                <h3>Personal Info</h3>
                <ul>
                    <li><strong>Name:</strong> {{ user.last_name }}, {{ user.first_name }} {{ user.other_names }}</li>
                    <li><strong>Email:</strong> {{ user.email }}</li>
                    <li><strong>Phone:</strong> {{ user.phone_number }}</li>
                    <li><strong>Gender:</strong> {{ user.gender.name }}</li>
                </ul>
            </div>

            <!-- Work Info -->
            <div class="profile-card fade-in">
                <h3>Work Info</h3>
                <ul>
                    <li><strong>Group:</strong> {{ user.group.name }}</li>
                    <li><strong>Seniority:</strong> {{ user.seniority.name }}</li>
                    <li><strong>Status:</strong> {{ user.leave_status }}</li>
                    {% if is_approver %}
                    <li><strong>Approver:</strong> <span style="color: green;">Yes</span></li>
                    <li><strong>Level:</strong> {{ user.level.name }}</li>
                    {% else %}
                    <li><strong>Approver:</strong> <span style="color: green;">No</span></li>
                    {% endif %}
                </ul>
            </div>

            <!-- Leave Summary -->
            <div class="profile-card fade-in">
                <h3>Leave Summary</h3>
                <div class="leave-cards">
                    {% for detail in leave_details %}
                    <div class="leave-card">
                        <h4>{{ detail.leave_type.name }}</h4>
                        <p><strong>Entitled:</strong> {{ detail.leave_type.days }} days</p>
                        <p><strong>Taken:</strong> {{ detail.days_taken }} days</p>
                        <p><strong>Remaining:</strong> {{ detail.days_remaining }} days</p>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Form -->
    <div class="profile-change fade-in">
        <h2>Edit Profile</h2>
        <p class="note">You can only change your phone number and email address. To change other details, please contact your administrator.</p>
        <form method="post">
            {% csrf_token %}
            
            <div class="form-row">
                <label for="email-id">Email</label>
                <input type="email" name="email" id="email-id" value="{{ user.email }}">
            </div>
            <div class="form-row">
                <label for="phone-id">Phone</label>
                <input type="text" name="phone" id="phone-id" value="{{ user.phone_number }}">
            </div>
            <button type="submit" class="submit-btn">Submit</button>
        </form>
    </div>
</div>

{% endblock %}